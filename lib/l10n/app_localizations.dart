// lib/l10n/app_localizations.dart
import 'package:flutter/material.dart';

class AppLocalizations {
  final Locale locale;
  AppLocalizations(this.locale);

  static AppLocalizations? of(BuildContext context) {
    return Localizations.of<AppLocalizations>(context, AppLocalizations);
  }

  // Aqui ele chama a classe que estava faltando
  static const LocalizationsDelegate<AppLocalizations> delegate =
      _AppLocalizationsDelegate();

  static const List<Locale> supportedLocales = [
    Locale('pt', ''), // Português
    Locale('en', ''), // Inglês
    Locale('es', ''), // Espanhol
  ];
  
  // --- LISTAS ESTÁTICAS ---
  static const List<String> universidades = [
    'UFSCar - Campus Sorocaba'
  ];
  
  static const List<String> cursos = [
    'Administração',
    'Ciências Biológicas',
    'Ciência da Computação',
    'Ciências Econômicas',
    'Engenharia de Produção',
    'Engenharia Florestal',
    'Física',
    'Geografia',
    'Matemática',
    'Pedagogia',
    'Química',
    'Turismo'
  ];
  
  static const List<String> predios = [
    'ATLab', 
    'AT2', 
    'CCHB', 
    'CCTS',
    'CCGT',
    'FINEP 1',
    'FINEP 2',
  ];
  
  static const List<String> identificacaoProfessor = [
    'Matrícula SIAPE',
    'Registro Docente',
    'ID Externo'
  ];
  
  // --- DICIONÁRIO GLOBAL ---
  static final Map<String, Map<String, String>> _valores = {
    // --- PORTUGUÊS ---
    'pt': {
      'app_nome': 'Academic Connect',
      'login_titulo': 'Login',
      'login_subtitulo': 'Entre com seus dados de conta',
      'login_email': 'E-mail',
      'login_senha': 'Senha',
      'login_esqueceu_senha': 'Esqueceu a senha?',
      'login_entrar': 'Entrar',
      'login_ou_continue': 'Ou continue com',
      'login_nao_tem_conta': 'Não tem uma conta?',
      'login_cadastre_se': 'Cadastre-se',
      'login_bemvindo_arte': 'Bem-vindo ao\nPortal do Aluno',
      'login_acesso_arte': 'Faça login para acessar sua conta',
      'cadastro_titulo': 'Criar Conta',
      'cadastro_subtitulo': 'Preencha seus dados para começar',
      'cadastro_universidade': 'Universidade *',
      'cadastro_papel_label': 'Perfil *',
      'cadastro_nome_label': 'Nome Completo',
      'cadastro_curso': 'Curso *',
      'cadastro_ra_label': 'RA (Matrícula)',
      'cadastro_data_nasc_label': 'Data de Nascimento *',
      'cadastro_identificacao_prof': 'Tipo de Identificação',
      'cadastro_num_prof': 'Número de Identificação *',
      'cadastro_botao': 'Cadastrar',
      'cadastro_carregando': 'Cadastrando...',
      'cadastro_finalizar': 'Finalizar Cadastro',
      'cadastro_sucesso': 'Cadastro realizado com sucesso!',
      'cadastro_ja_tem_conta': 'Já tem uma conta?',
      'cadastro_entrar_link': 'Entrar',
      'cadastro_confirmar_senha': 'Confirmar Senha',
      'cadastro_erro_senha': 'As senhas não coincidem',
      'esqueceu_titulo': 'Esqueceu a Senha?',
      'esqueceu_subtitulo': 'Digite seu e-mail para enviarmos um link de recuperação.',
      'esqueceu_enviar': 'Enviar Link',
      'esqueceu_voltar_login': 'Lembrou a senha?',
      'esqueceu_login_link': 'Login',
      'papel_titulo': 'Como você usará o app?',
      'papel_subtitulo': 'Selecione seu perfil para continuar',
      'papel_aluno': 'Sou Aluno(a)',
      'papel_aluno_desc': 'Acesse suas notas, frequência e mais',
      'papel_professor': 'Sou Professor(a)',
      'papel_professor_desc': 'Gerencie turmas, presenças e notas',
      'papel_ca': 'Sou do C.A. / Projeto',
      'papel_ca_desc': 'Organize eventos e comunique alunos',
      'papel_desconhecido': 'Desconhecido',
      'config_titulo': 'Configurações',
      'config_secao_aparencia': 'APARÊNCIA',
      'config_secao_idioma': 'IDIOMA',
      'config_secao_geral': 'GERAL',
      'config_tema_claro': 'Modo Claro',
      'config_tema_escuro': 'Modo Escuro',
      'config_ajuda': 'Ajuda & Onboarding',
      'config_sair': 'Sair da Conta',
      'perfil_titulo': 'Perfil',
      'perfil_editar_btn': 'Editar Perfil',
      'perfil_info_academica': 'INFORMAÇÕES ACADÊMICAS',
      'perfil_info_profissional': 'INFORMAÇÕES PROFISSIONAIS',
      'perfil_sugestao_btn': 'Enviar Sugestão / Feedback',
      'perfil_subtitulo_sugestao': 'Ajude a melhorar o aplicativo.',
      'nav_inicio': 'Início',
      'nav_disciplinas': 'Disciplinas',
      'nav_perfil': 'Perfil',
      'nav_turmas': 'Turmas',
      'nav_solicitacoes': 'Solicitações',
      'nav_eventos': 'Eventos',
      'aluno_inicio_titulo': 'Início',
      'aluno_inicio_bemvindo': 'Bem-vindo(a)',
      'aluno_inicio_resumo': 'Aqui está um resumo da sua semana acadêmica',
      'inicio_ola': 'Olá',
      'inicio_subtitulo': 'Vamos estudar hoje!',
      'inicio_dashboard': 'Painel Geral',
      'inicio_acesso_rapido': 'Acesso Rápido',
      'inicio_proximas_avaliacoes': 'Próximas Avaliações',
      'inicio_btn_sincronizar': 'Sincronizar Dados',
      'inicio_sem_provas': 'Sem provas agendadas.',
      'aluno_inicio_freq_media': 'Sua Frequência',
      'aluno_inicio_freq_geral': 'Frequência Geral',
      'aluno_inicio_freq_acima': 'Você está acima do mínimo exigido de 75%',
      'aluno_inicio_freq_abaixo': 'Você está abaixo do mínimo exigido de 75%',
      'aluno_inicio_ver_detalhes': 'Ver Detalhes de Frequência',
      'aluno_inicio_provas': 'Próximas Provas',
      'aluno_inicio_notas': 'Minhas Notas',
      'aluno_inicio_adaptacoes': 'Adaptações',
      'aluno_inicio_cadastrar_nfc': 'Cadastrar Cartão NFC',
      'aluno_disciplinas_titulo': 'Minhas Disciplinas',
      'aluno_disciplinas_aviso': 'A frequência mínima exigida é de 75% em cada disciplina.',
      'aluno_disciplinas_faltas': 'faltas',
      'aluno_disciplinas_aulas': 'aulas',
      'aluno_disciplinas_frequencia': 'Frequência',
      'aluno_disciplinas_ver_notas': 'Notas e Detalhes',
      'aluno_disciplinas_acessar_materia': 'Acessar Matéria', 
      'entrar_turma_titulo': 'Entrar na Turma',
      'entrar_turma_label': 'Código da Turma',
      'entrar_turma_hint': 'Insira o código de 6 dígitos',
      'entrar_turma_botao': 'Entrar',
      'entrar_turma_sucesso': 'Você entrou na turma!',
      'aluno_perfil_titulo': 'Perfil',
      'aluno_perfil_editar': 'Editar Perfil',
      'aluno_perfil_info': 'Informações Acadêmicas',
      'aluno_perfil_cr': 'CR',
      'aluno_perfil_status': 'Status',
      'aluno_perfil_status_label': 'Status da Matrícula',
      'aluno_perfil_artigos': 'Dicas de Alunos',
      'aluno_perfil_carregando': 'Carregando perfil...',
      'aluno_perfil_nome_completo': 'Nome Completo',
      'aluno_perfil_ra': 'RA',
      'aluno_perfil_curso': 'Curso',
      'aluno_perfil_salvar': 'Salvar Perfil',
      'aluno_perfil_edit_sucesso': 'Perfil atualizado com sucesso!',
      'editar_perfil_titulo': 'Editar Perfil',
      'editar_perfil_aviso': 'Mantenha seus dados acadêmicos atualizados.',
      'nfc_cadastro_titulo': 'Cadastrar Cartão NFC',
      'nfc_cadastro_aguardando': 'Aguardando Cartão',
      'nfc_cadastro_instrucao': 'Aproxime o seu cartão RA do leitor NFC do celular.',
      'nfc_cadastro_sucesso': 'Cartão Lido com Sucesso!',
      'nfc_cadastro_uid': 'UID do Cartão:',
      'nfc_cadastro_erro': 'Erro na Leitura',
      'nfc_cadastro_nao_suportado': 'NFC Não Suportado',
      'nfc_cadastro_iniciar': 'Iniciar Leitura',
      'nfc_cadastro_cancelar': 'Cancelar',
      'nfc_cadastro_salvar': 'Salvar Cartão',
      'nfc_cadastro_voltar': 'Voltar',
      'notas_titulo': 'Minhas Notas e Avaliações',
      'notas_tab_notas': 'Notas por Disciplina',
      'notas_tab_provas': 'Próximas Provas',
      'notas_cr_geral': 'CR Geral',
      'notas_aprovado': 'Aprovado',
      'notas_em_curso': 'Em Análise',
      'notas_media': 'Média',
      'notas_avaliacao': 'Avaliação',
      'notas_data': 'Data',
      'notas_peso': 'Peso',
      'notas_nota': 'Nota',
      'notas_pendente': 'Pendente',
      'notas_proxima_prova': 'Próxima Prova:',
      'notas_provas_aviso': 'Organize seus estudos! Você tem',
      'notas_provas_aviso_plural': 'prova(s) agendada(s).',
      'notas_conteudo': 'Conteúdo:',
      'notas_sincronizar': 'Sincronizar com Calendário',
      'adaptacao_titulo': 'Solicitar Adaptação',
      'adaptacao_aviso': 'O professor será notificado. Solicite apenas se necessário e anexe um laudo se o professor exigir.',
      'adaptacao_disciplina': 'Selecionar Disciplina *',
      'adaptacao_descricao': 'Descreva sua necessidade *',
      'adaptacao_anexar': 'Anexar Laudo ou Documento',
      'adaptacao_formatos': 'Formatos aceitos: PDF, JPG, PNG (máx. 5MB)',
      'adaptacao_enviar': 'Enviar Solicitação',
      'adaptacao_anteriores': 'Solicitações Anteriores',
      'prof_titulo': 'Portal do Professor',
      'prof_bemvindo': 'Bem-vindo(a)',
      'prof_resumo': 'Gerencie suas turmas e atividades!',
      'prof_acao_presenca': 'Registrar Presença',
      'prof_acao_notas': 'Lançar Notas',
      'prof_acao_cadastrar_nfc': 'Cadastrar NFC Aluno',
      'prof_aulas_hoje': 'Aulas de Hoje',
      'prof_sem_aulas': 'Nenhuma aula programada para hoje.',
      'prof_solicitacoes': 'Solicitações Pendentes',
      'prof_sem_solicitacoes': 'Nenhuma solicitação pendente.',
      'prof_ver_todas': 'Ver Todas as Solicitações',
      'prof_visao_geral': 'Visão Geral',
      'prof_total_alunos': 'Total de Alunos',
      'prof_turmas_ativas': 'Turmas Ativas',
      'prof_turmas_titulo': 'Minhas Turmas',
      'prof_turmas_alunos': 'alunos',
      'prof_turmas_presenca_nfc': 'Presença NFC',
      'prof_turmas_chamada_manual': 'Chamada Manual',
      'prof_turmas_lancar_notas': 'Lançar Notas',
      'prof_turmas_marcar_prova': 'Marcar Prova',
      'prof_turmas_continuar_nfc': 'Continuar NFC',
      'prof_turmas_continuar_manual': 'Continuar Manual',
      'prof_solicitacoes_titulo': 'Solicitações de Alunos',
      'prof_solicitacoes_pendentes': 'pendentes',
      'prof_solicitacoes_ver_detalhes': 'Ver Detalhes',
      'prof_solicitacoes_aprovar': 'Aprovar',
      'prof_solicitacoes_recusar': 'Recusar',
      'prof_solicitacoes_dialog_titulo': 'Detalhes da Solicitação',
      'prof_solicitacoes_dialog_aluno': 'Aluno',
      'prof_solicitacoes_dialog_ra': 'RA',
      'prof_solicitacoes_dialog_disciplina': 'Disciplina',
      'prof_solicitacoes_dialog_tipo': 'Tipo',
      'prof_solicitacoes_dialog_data': 'Data',
      'prof_solicitacoes_dialog_status': 'Status',
      'prof_solicitacoes_dialog_descricao': 'Descrição',
      'prof_solicitacoes_dialog_anexo': 'Anexo',
      'prof_solicitacoes_dialog_baixar': 'Baixar Anexo',
      'prof_solicitacoes_dialog_fechar': 'Fechar',
      'prof_chamada_manual_titulo': 'Chamada Manual',
      'prof_presenca_presentes': 'Presentes',
      'prof_chamada_manual_todos': 'Todos',
      'prof_chamada_manual_limpar': 'Limpar',
      'prof_chamada_manual_salvar': 'Salvar Chamada',
      'prof_presenca_nfc_titulo': 'Registrar Presença (NFC)',
      'prof_presenca_nfc_pausada_titulo': 'Leitura NFC Pausada',
      'prof_presenca_nfc_pausada_desc': 'Clique em "Iniciar Leitura" para começar',
      'prof_presenca_nfc_lendo_titulo': 'Aguardando cartão do aluno...',
      'prof_presenca_nfc_lendo_desc': 'Os alunos devem aproximar seus cartões',
      'prof_presenca_nfc_indisponivel_titulo': 'NFC Indisponível',
      'prof_presenca_nfc_indisponivel_desc': 'Este dispositivo não suporta NFC.',
      'prof_presenca_nfc_erro_titulo': 'Erro na Leitura',
      'prof_presenca_nfc_erro_desc': 'Ocorreu um erro. Tente novamente.',
      'prof_presenca_nfc_pausar': 'Pausar Leitura',
      'prof_presenca_nfc_iniciar': 'Iniciar Leitura',
      'prof_presenca_nfc_finalizar': 'Finalizar e Salvar',
      'prof_presenca_nfc_registrados': 'Alunos Registrados',
      'prof_presenca_nfc_vazio': 'Nenhum aluno registrado ainda',
      'prof_presenca_nfc_presente': 'Presente',
      'prof_chamada_tipo_titulo': 'Tipo de Chamada',
      'prof_chamada_tipo_desc': 'Esta é a primeira chamada (início) ou a segunda (fim)?',
      'prof_chamada_tipo_inicio': 'Início',
      'prof_chamada_tipo_fim': 'Fim',
      'nfc_manual_titulo': 'Cadastro Manual de Cartão',
      'nfc_manual_selecionar_aluno': 'Selecione o Aluno',
      'nfc_manual_id_cartao': 'ID do Cartão (UID)',
      'nfc_manual_salvar': 'Vincular Cartão ao Aluno',
      'nfc_manual_sucesso': 'Cartão vinculado com sucesso!',
      'criar_turma_titulo': 'Criar Nova Turma',
      'criar_turma_nome': 'Nome da Disciplina *',
      'criar_turma_nome_hint': 'Ex: Desenvolvimento para Dispositivos Móveis',
      'criar_turma_horario': 'Horário e Dia *',
      'criar_turma_horario_hint': 'Ex: Seg 14:00-16:00, Qua 14:00-16:00',
      'criar_turma_local': 'Local (Prédio e Sala) *',
      'criar_turma_local_hint': 'Ex: AT1 - Sala 105',
      'criar_turma_botao': 'Criar Turma e Gerar Código',
      'criar_turma_sucesso': 'Turma Criada!',
      'criar_turma_codigo_desc': 'Compartilhe este código com seus alunos:',
      'criar_turma_ok': 'OK',
      'chamada_aviso_passado': 'Chamada em modo retroativo. Selecione a data da aula:',
      'chamada_aviso_futuro': 'A chamada só pode ser feita na hora da aula.',
      'chamada_aviso_creditos': 'Atenção: Apenas uma chamada é permitida para aulas de 2 créditos.',
      'chamada_aviso_duas_chamadas': 'Atenção: A primeira chamada (Início) já foi realizada.',
      'ca_titulo': 'Portal C.A. / Projeto',
      'ca_inicio_bemvindo': 'Bem-vindo, Centro Acadêmico!',
      'ca_inicio_resumo': 'Gerencie seus eventos e comunicados.',
      'ca_acao_presenca': 'Registrar Presença (Evento)',
      'ca_acao_presenca_desc': 'Iniciar leitura NFC para um evento.',
      'ca_links_uteis': 'Links Úteis do Campus',
      'ca_eventos_titulo': 'Eventos',
      'ca_eventos_proximos': 'Próximos Eventos',
      'ca_eventos_inscritos': 'inscritos',
      'ca_eventos_iniciar_registro': 'Iniciar Registro de Presença',
      'ca_eventos_criar_titulo': 'Criar Novo Evento',
      'ca_eventos_criar_nome': 'Nome do Evento *',
      'ca_eventos_criar_data': 'Selecionar Data *',
      'ca_eventos_criar_local': 'Local *',
      'ca_eventos_criar_participantes': 'Nº de Participantes (Estimado)',
      'ca_eventos_criar_salvar': 'Salvar Evento',
      'ca_comunicado_titulo': 'Enviar Comunicado',
      'ca_comunicado_para': 'Enviar para:',
      'ca_comunicado_assunto': 'Assunto *',
      'ca_comunicado_mensagem': 'Mensagem *',
      'ca_comunicado_anexar': 'Anexar Certificados (Opcional)',
      'ca_comunicado_enviar': 'Enviar Comunicado',
      'ca_titulo_inicio': 'Início C.A.',
      'ca_titulo_eventos': 'Eventos',
      'ca_presenca_titulo': 'Registrar Presença (Evento)',
      'ca_presenca_registrados': 'Participantes Registrados',
      'ca_presenca_vazio': 'Nenhum participante registrado ainda',
      'ca_presenca_salva_sucesso': 'Presença salva com sucesso!',
      'ca_presenca_nfc_lendo_titulo': 'Aguardando cartão...',
      'ca_presenca_nfc_lendo_desc': 'Os participantes devem aproximar seus cartões',
      'hub_chat': 'Chat da Turma',
      'hub_materiais': 'Materiais',
      'hub_dicas': 'Dicas da Turma',
      'hub_chat_materiais': 'Chat e Materiais',
      'materiais_vazio_aluno': 'Nenhum material postado pelo professor.',
      'materiais_vazio_prof': 'Nenhum material postado. Clique no + para adicionar.',
      'materiais_add_titulo': 'Adicionar Material',
      'materiais_add_titulo_label': 'Título *',
      'materiais_add_desc': 'Descrição (Opcional)',
      'materiais_add_url': 'Link (URL) *',
      'materiais_add_tipo': 'Tipo *',
      'materiais_add_salvar': 'Salvar Material',
      'materiais_add_sucesso': 'Material salvo!',
      'materiais_tipo_link': 'Link Útil',
      'materiais_tipo_video': 'Vídeo Aula',
      'materiais_tipo_prova': 'Prova Antiga / Lista',
      'materiais_tipo_outro': 'Outro',
      'dicas_titulo': 'Dicas para Próximos Alunos',
      'dicas_subtitulo': 'Deixe uma dica anônima sobre esta matéria.',
      'dicas_placeholder': 'Escreva sua dica aqui...',
      'dicas_postar_botao': 'Postar Dica',
      'dicas_postar_sucesso': 'Dica postada!',
      'dicas_vazio': 'Nenhuma dica postada ainda. Seja o primeiro!',
      'card_frequencia': 'Frequência',
      'card_notas': 'Notas',
      'card_adaptacao': 'Adaptação',
      'card_nfc': 'Cartão NFC',
      'card_drive': 'Drive Provas',
      'card_dicas': 'Dicas Gerais',
    },
    // --- INGLÊS E ESPANHOL ---
    // (Mantidos para evitar erros de chave faltante, copie os do bloco acima se quiser)
    'en': { 'login_titulo': 'Academic Connect' },
    'es': { 'login_titulo': 'Academic Connect' },
  };

  String t(String key, {List<String>? args}) {
    String? value = _valores[locale.languageCode]?[key];
    if (value == null) return '$key';
    if (args != null) {
      for (int i = 0; i < args.length; i++) {
        value = value!.replaceFirst('{}', args[i]);
      }
    }
    return value!;
  }
}

// --- CLASSE QUE FALTAVA ---
class _AppLocalizationsDelegate extends LocalizationsDelegate<AppLocalizations> {
  const _AppLocalizationsDelegate();

  @override
  bool isSupported(Locale locale) {
    return AppLocalizations.supportedLocales
        .map((l) => l.languageCode)
        .contains(locale.languageCode);
  }

  @override
  Future<AppLocalizations> load(Locale locale) async {
    return AppLocalizations(locale);
  }

  @override
  bool shouldReload(_AppLocalizationsDelegate old) => false;
}